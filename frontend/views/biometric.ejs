<div class="biometric-container">
  <div class="back-button">
    <a href="/voter-id">‚Üê</a>
  </div>

  <div class="biometric-content">
    <h1 id="page-title">Biometric Verification</h1>
    <p id="page-instruction">Place your face directly into the camera, and we'll scan it.</p>
    
    <div id="scanning-container" class="camera-container">
      <div class="scanner-icon">
        <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="5" y="5" width="30" height="30" rx="2" stroke="#666" stroke-width="2" fill="none"/>
          <circle cx="20" cy="20" r="10" stroke="#666" stroke-width="2" fill="none"/>
          <path d="M13 15 L13 13 L15 13" stroke="#666" stroke-width="2"/>
          <path d="M27 15 L27 13 L25 13" stroke="#666" stroke-width="2"/>
          <path d="M13 25 L13 27 L15 27" stroke="#666" stroke-width="2"/>
          <path d="M27 25 L27 27 L25 27" stroke="#666" stroke-width="2"/>
        </svg>
      </div>
      <p>Scanning...</p>
    </div>
    
    <div id="verified-container" class="verification-success-container" style="display: none;">
      <div class="success-icon">
        <svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="30" cy="30" r="28" stroke="#28a745" stroke-width="4" fill="none"/>
          <path d="M20 30 L28 38 L40 22" stroke="#28a745" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <h2>Verified</h2>
      <p class="verification-message">Below is your digital key you will need in order to submit your ballot.</p>
      
      <div class="digital-key-container">
        <input type="text" id="digital-key" class="digital-key-display" value="" readonly>
        <button id="copy-key-btn" class="copy-key-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
          </svg>
          Copy Digital Key
        </button>
      </div>
    </div>
    
    <button id="next-btn" class="next-btn">Next</button>
  </div>
  
  <div class="biometric-preview">
    <div class="camera-feed">
      <div class="face-overlay">
        <svg width="300" height="300" viewBox="0 0 300 300" fill="none" xmlns="http://www.w3.org/2000/svg">
          <!-- Facial recognition grid skeleton -->
          <path d="M150 80 C 110 80, 80 120, 80 170 C 80 220, 110 260, 150 260 C 190 260, 220 220, 220 170 C 220 120, 190 80, 150 80" stroke="white" stroke-width="2"/>
          <!-- Eyes -->
          <circle cx="120" cy="140" r="10" stroke="white" stroke-width="2"/>
          <circle cx="180" cy="140" r="10" stroke="white" stroke-width="2"/>
          <!-- Nose -->
          <line x1="150" y1="140" x2="150" y2="180" stroke="white" stroke-width="2"/>
          <!-- Mouth -->
          <path d="M120 210 C 130 220, 170 220, 180 210" stroke="white" stroke-width="2"/>
          <!-- Jaw line -->
          <line x1="100" y1="120" x2="80" y2="140" stroke="white" stroke-width="2"/>
          <line x1="200" y1="120" x2="220" y2="140" stroke="white" stroke-width="2"/>
          <line x1="80" y1="140" x2="80" y2="200" stroke="white" stroke-width="2"/>
          <line x1="220" y1="140" x2="220" y2="200" stroke="white" stroke-width="2"/>
          <line x1="80" y1="200" x2="100" y2="240" stroke="white" stroke-width="2"/>
          <line x1="220" y1="200" x2="200" y2="240" stroke="white" stroke-width="2"/>
          <line x1="100" y1="240" x2="200" y2="240" stroke="white" stroke-width="2"/>
          
          <!-- Connection points -->
          <circle cx="150" cy="80" r="3" fill="white"/>
          <circle cx="110" cy="80" r="3" fill="white"/>
          <circle cx="190" cy="80" r="3" fill="white"/>
          <circle cx="80" cy="140" r="3" fill="white"/>
          <circle cx="220" cy="140" r="3" fill="white"/>
          <circle cx="80" cy="200" r="3" fill="white"/>
          <circle cx="220" cy="200" r="3" fill="white"/>
          <circle cx="100" cy="240" r="3" fill="white"/>
          <circle cx="200" cy="240" r="3" fill="white"/>
          <circle cx="120" cy="140" r="3" fill="white"/>
          <circle cx="180" cy="140" r="3" fill="white"/>
          <circle cx="150" cy="180" r="3" fill="white"/>
          <circle cx="120" cy="210" r="3" fill="white"/>
          <circle cx="180" cy="210" r="3" fill="white"/>
          <circle cx="150" cy="220" r="3" fill="white"/>
        </svg>
      </div>
    </div>
  </div>
</div>

<script>
  // Generate a random digital key
  function generateDigitalKey() {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
    let key = '';
    for (let i = 0; i < 16; i++) {
      key += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    return key;
  }
  
  // Store the digital key in localStorage for later use during voting
  const digitalKey = generateDigitalKey();
  localStorage.setItem('voterDigitalKey', digitalKey);
  
  // Simulate a facial recognition process
  setTimeout(() => {
    document.getElementById('scanning-container').style.display = 'none';
    document.getElementById('verified-container').style.display = 'flex';
    document.getElementById('digital-key').value = digitalKey;
    document.getElementById('next-btn').classList.add('active');
  }, 3000);
  
  // Copy digital key to clipboard
  document.getElementById('copy-key-btn').addEventListener('click', function() {
    const digitalKeyInput = document.getElementById('digital-key');
    digitalKeyInput.select();
    document.execCommand('copy');
    this.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg> Copied!';
    setTimeout(() => {
      this.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg> Copy Digital Key';
    }, 2000);
  });
  
  // Next button
  document.getElementById('next-btn').addEventListener('click', function() {
    if (this.classList.contains('active')) {
      // Get the ballot ID from URL params if available
      const urlParams = new URLSearchParams(window.location.search);
      const ballotId = urlParams.get('ballot') || '2024_presidential';
      
      // Save verification status
      localStorage.setItem('biometricVerified', 'true');
      
      // Redirect to ballot page
      window.location.href = `/ballot/${ballotId}`;
    }
  });
</script>

<style>
  .biometric-container {
    display: flex;
    min-height: 100vh;
    width: 100%;
  }
  
  .biometric-content {
    width: 50%;
    padding: 40px;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: flex-start;
    background-color: white;
    margin-left: auto;
  }
  
  .biometric-preview {
    width: 50%;
    background-color: #333;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  
  .camera-feed {
    width: 300px;
    height: 300px;
    background-color: #222;
    border-radius: 50%;
    overflow: hidden;
    position: relative;
  }
  
  .face-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  
  .camera-container {
    border: 2px solid #ddd;
    border-radius: 10px;
    padding: 20px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    margin: 40px 0;
    width: 100%;
  }
  
  .verification-success-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 40px 0;
    width: 100%;
  }
  
  .verification-message {
    text-align: center;
    margin: 20px 0;
  }
  
  .success-icon {
    margin-bottom: 20px;
  }
  
  .digital-key-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    margin-top: 20px;
  }
  
  .digital-key-display {
    width: 100%;
    padding: 15px;
    background-color: #f5f5f5;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-family: monospace;
    font-size: 16px;
    text-align: center;
    margin-bottom: 15px;
  }
  
  .copy-key-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    background-color: #1D2939;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 12px 25px;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  
  .copy-key-btn:hover {
    background-color: #000022;
  }
  
  .scanner-icon {
    margin-bottom: 10px;
  }
  
  .back-button {
    position: absolute;
    top: 20px;
    left: 20px;
    z-index: 10;
  }
  
  .back-button a {
    text-decoration: none;
    color: var(--primary-color);
    font-size: 24px;
    font-weight: bold;
  }
  
  .next-btn {
    background-color: #ccc;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 12px 30px;
    font-size: 16px;
    font-weight: 500;
    cursor: not-allowed;
    transition: background-color 0.3s;
  }
  
  .next-btn.active {
    background-color: var(--accent-color);
    cursor: pointer;
  }
  
  .next-btn.active:hover {
    background-color: var(--primary-color);
  }
</style> 